(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-686b7d14"],{"551f1":function(e,t,a){},"72a4":function(e,t,a){"use strict";a("551f1")},"9cb2":function(e,t,a){"use strict";a("d03f")},b829:function(e,t,a){"use strict";a.r(t);a("e9f5"),a("ab43");var i=a("dabc"),o={name:"RecordManage",components:{TableList:a("ca7f").a},data:()=>({records:[],tableMap:[{label:"索引",key:"id"},{label:"记录时间",key:"time"}],total:0,searchFormMap:[{label:"索引",type:"input",key:"id",show:!0,span:5},{label:"记录时间",key:"time",value:"",type:"date-picker",show:!0,span:11}],pageNo:1,pageSize:10}),activated(){this.queryRecord()},mounted(){},methods:{handleCopy(e,t){const{_id:a}=t;this.API.record.copyRecord({_id:a}).then(e=>{i.h.copyTextToClip(JSON.stringify(e.data),()=>{alert("已复制日志数据")})})},queryRecord(){let e=this.$refs.tableList.getFormData(),t=Object.assign({pageNo:this.pageNo,pageSize:this.pageSize},e);this.API.record.findRecordByPage(t,{notify:!1}).then(e=>{this.records=e.data.list.sort((e,t)=>t.time-e.time),this.total=e.data.total})},updatePagination(e,t){this.pageNo=e,this.pageSize=t},removeRecord(e,t,a,i){this.API.record.removeRecord({_id:t._id}).then(e=>{this.queryRecord()})},handleRemoveMany(e){let t=e.map(e=>e._id);this.API.record.removeManyRecord({_ids:t}).then(e=>{this.queryRecord()})},paginationChange(e,t){this.queryRecord()}}},n=(a("72a4"),a("2877")),l=Object(n.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"record-manage p-px-10"},[t("TableList",{ref:"tableList",attrs:{tableData:e.records,tableMap:e.tableMap,formMap:e.searchFormMap,showAdd:!1,showEdit:!1,showCopy:!0,showSelection:!0,total:e.total},on:{remove:e.removeRecord,removeMany:e.handleRemoveMany,search:e.queryRecord,copy:e.handleCopy,paginationChange:e.paginationChange,updatePagination:e.updatePagination}})],1)}),[],!1,null,"008827f8",null);t.default=l.exports},ca7f:function(e,t,a){"use strict";a("e9f5"),a("910d"),a("7d54");var i=a("dabc"),o={components:{HSDialog:a("8c8a").a},name:"TableList",props:{formMap:{type:Array,default:()=>[{span:6,label:"姓名",type:"input",key:"name"}]},tableMap:{type:Array,default:()=>[{label:"日期",key:"data"}]},tableData:{type:Array,default:()=>[{date:"1979-01-01"}]},total:{type:Number,default:0},showAdd:{type:Boolean,default:!1},showAddMany:{type:Boolean,default:!1},showRemove:{type:Boolean,default:!0},showEdit:{type:Boolean,default:!0},showRelation:{type:Boolean,default:!1},showCopy:{type:Boolean,default:!1},showSelection:{type:Boolean,default:!1},showDetail:{type:Boolean,default:!1}},computed:{visiableFormMap(){return this.formMap.filter(e=>e.show)},showContent(){return 0!==this.tableMap.length},showHeader(){return 0!==this.formMap.length}},data:()=>({formData:{},pagination:{pageNo:1,pageSize:10},showRemoveMany:!1,showFilterDialog:!1}),watch:{formMap:{handler(e){const t={};e.forEach(e=>{e.show&&(t[e.key]=e.value)}),this.formData=t},deep:!0,immediate:!0},pagination:{handler(e){this.$emit("updatePagination",e.pageNo,e.pageSize)},deep:!0,immediate:!0}},methods:{getFormData(){return this.formData},handleFilterVisiable(e,t){if(this.visiableFormMap.length<1)return this.$message.error("至少保留一个筛选条件"),void this.$set(t,"show",!0)},handleFilterSelectionChange(e){this.filterForm=e},handleSelectionChange(){this.showRemoveMany=0!==this.$refs.table.selection.length},handlePlaceHolder:e=>"请输入"+e.label,handlePageSizeChange(e){this.pagination.pageSize=e,this.handleEmit("paginationChange",this.pagination.pageNo,e)},handlePageNoChange(e){this.pagination.pageNo=e,this.handleEmit("paginationChange",e,this.pagination.pageSize)},add(){this.$emit("add")},addMany(){this.$emit("addMany")},remove(e,t){this.handleEmit("remove",e,t,this.pagination.pageNo,this.pagination.pageSize)},removeMany(){let e=this.$refs.table.selection||[];this.handleEmit("removeMany",e)},edit(e,t){this.$emit("edit",e,t)},detail(e,t){this.$emit("detail",e,t)},relation(e,t){this.$emit("relation",e,t)},copy(e,t){this.$emit("copy",e,t)},search(){this.pagination={pageNo:1,pageSize:10},this.handleEmit("search",this.pagination.pageNo,this.pagination.pageSize)},formatDate:e=>e?i.h.formatDate(e,"YYYY-MM-DD HH:mm:ss"):"--",handleEmit(e){this.$nextTick(()=>{let t=[...Array.from(arguments)];t.shift(),this.$emit(e,...t)})},handleCopy(e,t,a,o){i.h.copyTextToClip(a.innerText,()=>{alert("已拷贝单元格内容")})}}},n=(a("9cb2"),a("2877")),l=Object(n.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-list"},[e.showHeader?t("header",[t("el-form",{ref:"searchForm",attrs:{inline:!0,model:e.formData}},[t("el-row",{attrs:{gutter:10}},[e._l(e.visiableFormMap,(function(a,i){return t("el-col",{key:i,attrs:{span:a.span||5}},[void 0===a.show||a.show?t("el-form-item",{staticClass:"search-item",attrs:{prop:a.key}},[t("div",{staticClass:"control"},["input"==a.type?t("el-input",{attrs:{placeholder:e.handlePlaceHolder(a),clearable:""},on:{clear:e.search},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.formData[a.key],callback:function(t){e.$set(e.formData,a.key,t)},expression:"formData[formItem.key]"}}):e._e(),"select"==a.type?t("el-select",{attrs:{placeholder:e.handlePlaceHolder(a)},on:{change:e.search},model:{value:e.formData[a.key],callback:function(t){e.$set(e.formData,a.key,t)},expression:"formData[formItem.key]"}},[t("el-option",{attrs:{label:"全部",value:void 0}}),e._l(a.typeConfig.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],2):e._e(),"switch"==a.type?t("el-switch",{attrs:{"active-value":"true","inactive-value":"false","active-text":"是","inactive-text":"否"},on:{change:e.search},model:{value:e.formData[a.key],callback:function(t){e.$set(e.formData,a.key,t)},expression:"formData[formItem.key]"}}):e._e(),"date-picker"==a.type?t("el-date-picker",{staticStyle:{width:"100%"},attrs:{align:"center",type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:e.search},model:{value:e.formData[a.key],callback:function(t){e.$set(e.formData,a.key,t)},expression:"formData[formItem.key]"}}):e._e()],1),i===e.visiableFormMap.length-1?t("div",{staticClass:"more"},[t("el-button",{attrs:{size:"mini",icon:"iconfont icon-guolv"},on:{click:function(t){e.showFilterDialog=!0}}},[e._v("筛选")])],1):e._e()]):e._e()],1)})),t("el-col",{attrs:{span:8}},[t("el-form-item",[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")]),e.showAdd?t("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-plus"},on:{click:e.add}},[e._v("添加")]):e._e(),e.showAddMany?t("el-button",{attrs:{size:"mini",type:"info"},on:{click:e.addMany}},[e._v("导入/出")]):e._e(),e.showRemoveMany?t("el-popconfirm",{staticClass:"ml-px-10",attrs:{"popper-class":"delete-popcomfirm",title:"确定删除吗？"},on:{confirm:e.removeMany}},[t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("批量删除")])],1):e._e()],1)],1)],2)],1)],1):e._e(),e.showContent?t("main",[t("el-table",{ref:"table",attrs:{data:e.tableData,stripe:!0,border:!0,"highlight-current-row":"",height:"100%"},on:{"selection-change":e.handleSelectionChange,"cell-dblclick":e.handleCopy}},[e.showSelection?t("el-table-column",{attrs:{type:"selection",width:"48"}}):e._e(),t("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),e._l(e.tableMap,(function(a,i){return t("el-table-column",{key:i,attrs:{label:a.label,width:a.width,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(i){return["icon"===a.key?[t("div",{staticClass:"w-full h-px-30 flex items-center"},[t("img",{directives:[{name:"lazy",rawName:"v-lazy"}],staticClass:"max-w-full max-h-full",attrs:{src:i.row[a.key]}})])]:"createTime"===a.key||"updateTime"===a.key?[t("div",{staticClass:"text"},[e._v(e._s(e.formatDate(i.row[a.key])))])]:"code"===a.key?[3===i.row[a.key]?t("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v("作者权限")]):e._e(),2===i.row[a.key]?t("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v("管理权限")]):e._e(),1===i.row[a.key]?t("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("特权用户")]):e._e(),0===i.row[a.key]?t("el-tag",{attrs:{size:"mini"}},[e._v("普通用户")]):e._e()]:"enabled"===a.key?[t("el-switch",{attrs:{size:"mini",disabled:""},model:{value:i.row[a.key],callback:function(t){e.$set(i.row,a.key,t)},expression:"scope.row[col.key]"}})]:t("div",{staticClass:"text"},[e._v(e._s(e._f("emptyTip")(i.row[a.key])))])]}}],null,!0)})})),t("el-table-column",{attrs:{label:"操作",width:240},scopedSlots:e._u([{key:"default",fn:function(a){return[e.showDetail?t("el-button",{attrs:{size:"mini",plain:""},on:{click:function(t){return e.detail(a.$index,a.row)}}},[e._v("详情书")]):e._e(),e.showRelation?t("el-button",{attrs:{size:"mini",type:"info",plain:""},on:{click:function(t){return e.relation(a.$index,a.row)}}},[e._v("关联")]):e._e(),e.showCopy?t("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(t){return e.copy(a.$index,a.row)}}},[e._v("复制")]):e._e(),e.showEdit?t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.edit(a.$index,a.row)}}},[e._v("编辑")]):e._e(),e.showRemove?t("el-popconfirm",{staticClass:"ml-px-10",attrs:{"popper-class":"delete-popcomfirm",title:"确定删除吗？"},on:{confirm:function(t){return e.remove(a.$index,a.row)}}},[t("el-button",{attrs:{slot:"reference",size:"mini",plain:"",type:"danger"},slot:"reference"},[e._v("删除")])],1):e._e()]}}],null,!1,1168878365)})],2)],1):e._e(),e.showContent?t("footer",[t("el-pagination",{staticClass:"flex mt-px-28",attrs:{"current-page":e.pagination.pageNo,background:"","page-sizes":[10,20,50,100],pageSize:e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"popper-class":"page-size-popper"},on:{"size-change":e.handlePageSizeChange,"current-change":e.handlePageNoChange}})],1):e._e(),e.showFilterDialog?t("HSDialog",{attrs:{title:"编辑过滤条件",width:"480px",maxHeight:"500px",visible:e.showFilterDialog},on:{"update:visible":function(t){e.showFilterDialog=t}}},[t("el-table",{attrs:{height:"100%",data:this.formMap,stripe:""}},[t("el-table-column",{attrs:{property:"label",label:"条件名称"}}),t("el-table-column",{attrs:{property:"key",label:"条件关键词"}}),t("el-table-column",{attrs:{label:"显示状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{size:"mini"},on:{change:t=>e.handleFilterVisiable(t,a.row)},model:{value:a.row.show,callback:function(t){e.$set(a.row,"show",t)},expression:"scope.row.show"}})]}}],null,!1,1123503978)})],1)],1):e._e()],1)}),[],!1,null,"5ebdf94c",null);t.a=l.exports},d03f:function(e,t,a){}}]);
//# sourceMappingURL=chunk-686b7d14.ef166fc1.js.map