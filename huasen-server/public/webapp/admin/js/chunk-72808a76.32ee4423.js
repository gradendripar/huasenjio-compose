(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-72808a76","chunk-254a77fc","chunk-60a4cd68"],{"2cd2":function(e,t,a){"use strict";a.r(t);var i=a("af15"),s=a("afc1"),o={name:"AccountManage",data:()=>({activeName:"user"}),components:{AccountUser:i.default,AccountBlacklist:s.default}},l=(a("626a"),a("2877")),n=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"account-manage"},[t("el-tabs",{staticClass:"tab-group",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"用户列表",name:"user"}},[t("AccountUser")],1),t("el-tab-pane",{attrs:{label:"黑名单列表",name:"blacklist"}},[t("AccountBlacklist")],1)],1)],1)}),[],!1,null,"262d5a98",null);t.default=n.exports},"409f":function(e,t,a){"use strict";a("65f6")},"626a":function(e,t,a){"use strict";a("c43f")},"65f6":function(e,t,a){},"8cd3":function(e,t,a){},af15:function(e,t,a){"use strict";a.r(t);a("e9f5"),a("f665");var i=a("ca7f"),s=a("102f");const o=new(a("dabc").b),l=o.getElementFormValidator.bind(o);var n={name:"AccountUser",components:{TableList:i.a,DialogForm:s.a},data(){return{users:[],tableMap:[{label:"账号",key:"id"},{label:"密码",key:"password"},{label:"昵称",key:"name"},{label:"头像",key:"headImg"},{label:"收录站点",key:"records"},{label:"配置",key:"config"},{label:"权限码",key:"code"},{label:"注册时间",key:"createTime"},{label:"更新时间",key:"updateTime"},{label:"是否启用",key:"enabled"}],total:0,searchFormMap:[{label:"账号",type:"input",key:"id",show:!0},{label:"昵称",type:"input",key:"name",show:!0},{label:"权限码",key:"code",type:"select",typeConfig:{options:this.CONSTANT.dictionary.code},show:!0},{label:"是否可用",key:"enabled",type:"select",value:void 0,typeConfig:{options:[{label:"可用",value:!0},{label:"禁用",value:!1}]},show:!1}],show:!1,mode:"add",formMap:[{label:"账号",key:"id",type:"input",editDisabled:!0},{label:"密码",key:"password",type:"input"},{label:"昵称",key:"name",type:"input"},{label:"头像",key:"headImg",type:"input"},{label:"收录站点",key:"records",type:"input"},{label:"配置",key:"config",type:"input"},{label:"权限码",key:"code",type:"select",typeConfig:{options:this.CONSTANT.dictionary.code}},{label:"是否可用",key:"enabled",type:"switch",disabled:!1}],rule:{id:[{validator:l(["isNonEmpty::必填项","minLength:5::长度小于5","maxLength:50::长度大于50","isEmail::请输入邮箱"])}],password:[{validator:l(["isNonEmpty::必填项","minLength:5::长度小于5"])}],name:[{validator:l(["minLength:2::长度小于2","maxLength:20::长度大于20"])}]},form:{id:"",password:"",code:0,name:"",headImg:"",records:"",config:"",enabled:!0},pageNo:1,pageSize:10}},watch:{"form.code":{handler(e){let t=this.formMap.find(e=>"enabled"===e.key);e<2?t.disabled=!1:(this.form.enabled=!0,t.disabled=!0)},deep:!0}},activated(){this.queryUser()},mounted(){},methods:{queryUser(){let e=this.$refs.tableList.getFormData(),t=Object.assign({pageNo:this.pageNo,pageSize:this.pageSize},e);this.API.user.findUserByPage(t,{notify:!1}).then(e=>{this.users=e.data.list,this.total=e.data.total,this.cancel()})},updatePagination(e,t){this.pageNo=e,this.pageSize=t},removeUser(e,t,a,i){this.$store.state.manage.id!==t.id?this.API.user.removeUser({_id:t._id}).then(e=>{this.queryUser()}):this.$tips("error","当前登录账号，不允许被删除！","top-right",1200)},addUser(){this.show=!0,this.mode="add"},editUser(e,t){this.show=!0,this.mode="edit",this.$nextTick(()=>{this.form=Object.assign(this.form,t)})},paginationChange(e,t){this.queryUser()},save(){"edit"===this.mode?this.API.user.updateUser(this.form).then(e=>{this.queryUser()}):"add"===this.mode&&(delete this.form._id,delete this.form._v,this.API.user.addUser(this.form).then(e=>{this.queryUser()}))},cancel(){this.$refs.dialogForm&&this.$refs.dialogForm.close(),this.show=!1}}},r=(a("ed2a"),a("2877")),d=Object(r.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"account-user"},[t("TableList",{ref:"tableList",attrs:{tableData:e.users,tableMap:e.tableMap,formMap:e.searchFormMap,showAdd:!0,total:e.total},on:{edit:e.editUser,add:e.addUser,remove:e.removeUser,search:e.queryUser,paginationChange:e.paginationChange,updatePagination:e.updatePagination}}),e.show?t("DialogForm",{ref:"dialogForm",attrs:{width:"460",title:"add"==e.mode?"添加用户":"编辑用户",visible:e.show,mode:e.mode,"close-on-click-modal":!1,buttons:{comfirm:"确 认",cancel:"取 消"},formMap:e.formMap,formData:e.form,formRule:e.rule},on:{"update:visible":function(t){e.show=t},"update:formData":function(t){e.form=t},"update:form-data":function(t){e.form=t},comfirmForm:e.save,cancelForm:e.cancel}}):e._e()],1)}),[],!1,null,null,null);t.default=d.exports},afc1:function(e,t,a){"use strict";a.r(t);var i=a("ca7f"),s=a("102f");const o=new(a("dabc").b),l=o.getElementFormValidator.bind(o);var n={name:"AccountBlacklist",components:{TableList:i.a,DialogForm:s.a},data:()=>({blacklist:[],tableMap:[{label:"IP地址",key:"ip"}],total:0,searchFormMap:[{label:"IP地址",type:"input",key:"ip",show:!0}],show:!1,mode:"add",formMap:[{label:"IPV4地址",key:"ip",type:"input",editDisabled:!0}],rule:{ip:[{validator:l(["isNonEmpty::必填项","isIp::请输入正确IP地址"])}]},form:{ip:""},pageNo:1,pageSize:10}),activated(){this.queryBlacklist()},mounted(){},methods:{queryBlacklist(){let e=this.$refs.tableList.getFormData(),t=Object.assign({pageNo:this.pageNo,pageSize:this.pageSize},e);this.API.blacklist.findBlacklistByPage(t,{notify:!1}).then(e=>{this.blacklist=e.data.list,this.total=e.data.total,this.cancel()})},updatePagination(e,t){this.pageNo=e,this.pageSize=t},removeBlacklist(e,t,a,i){this.API.blacklist.removeBlacklist({ip:t.ip}).then(e=>{this.queryBlacklist()})},addBlacklist(){this.show=!0,this.mode="add"},editBlacklist(e,t){this.show=!0,this.mode="edit",this.$nextTick(()=>{this.form=Object.assign(this.form,t)})},paginationChange(e,t){this.queryBlacklist()},save(){"edit"===this.mode||"add"===this.mode&&this.API.blacklist.addBlacklist(this.form).then(e=>{this.queryBlacklist()})},cancel(){this.$refs.dialogForm&&this.$refs.dialogForm.close(),this.show=!1}}},r=(a("409f"),a("2877")),d=Object(r.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"account-blacklist"},[t("TableList",{ref:"tableList",attrs:{tableData:e.blacklist,tableMap:e.tableMap,formMap:e.searchFormMap,showAdd:!0,showEdit:!1,total:e.total},on:{edit:e.editBlacklist,add:e.addBlacklist,remove:e.removeBlacklist,search:e.queryBlacklist,paginationChange:e.paginationChange,updatePagination:e.updatePagination}}),e.show?t("DialogForm",{ref:"dialogForm",attrs:{width:"460",title:"add"==e.mode?"添加黑名单":"编辑黑名单",visible:e.show,mode:e.mode,"close-on-click-modal":!1,buttons:{comfirm:"确 认",cancel:"取 消"},formMap:e.formMap,formData:e.form,formRule:e.rule},on:{"update:visible":function(t){e.show=t},"update:formData":function(t){e.form=t},"update:form-data":function(t){e.form=t},comfirmForm:e.save,cancelForm:e.cancel}}):e._e()],1)}),[],!1,null,null,null);t.default=d.exports},c43f:function(e,t,a){},ed2a:function(e,t,a){"use strict";a("8cd3")}}]);
//# sourceMappingURL=chunk-72808a76.32ee4423.js.map